@let activeJokeType = $activeJokeType(); 
<!-- @let errorMessage = this.$errorMessage(); -->

<mat-card>
  @if ($jokes.isLoading()) {
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  }
  <mat-card-header>Joke types | new</mat-card-header>
  <mat-card-content>
    <mat-chip-listbox
      class="mat-mdc-chip-set"
      aria-label="Cutest dog breeds"
      (change)="$activeJokeType.set($event.value)"
    >
      @for (type of $jokeTypes.value(); track type) {
      <mat-chip-option [selected]="activeJokeType === type">{{
        type
      }}</mat-chip-option>
      }
    </mat-chip-listbox>
    {{ activeJokeType }}
    <mat-list role="list">
      @for (joke of $jokes.value(); track joke.id) {
      <mat-list-item role="listitem">
        <span matListItemTitle>{{ joke.setup }}</span>
        <span matListItemLine>{{ joke.punchline }}</span>
      </mat-list-item>
      <mat-divider></mat-divider>
      } @empty {
      <mat-list-item role="listitem">No Jokes found</mat-list-item>
      } @if ($jokes.error()) {
      <p class="error-message">{{ $jokes.error() }}</p>
      }
    </mat-list>
    <button mat-flat-button color="secondary" (click)="reload()">Reload</button>
  </mat-card-content>
</mat-card>
